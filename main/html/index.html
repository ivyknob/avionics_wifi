<!DOCTYPE html>
<html>
<head>
  <title>Avionics js</title>
  <script type="text/javascript" defer src="avionics.js"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
      window.avionics = new Avionics(document.body);

      var websocket = new WebSocket('ws://'+location.hostname+'/');

      websocket.onopen = function(evt) {
        console.log('WebSocket connection opened');
      }

      websocket.onmessage = function(evt) {
        var data = JSON.parse(evt.data);
        avionics.roll = data.roll;
        avionics.pitch = data.pitch;
        avionics.currentHeading = data.heading;
        avionics.altitude = data.altitude;
        avionics.airspeed = data.airspeed;
        avionics.selectedAltitude = data.desired_altitude;
        avionics.groundSpeed = data.ground_speed;
      }

      websocket.onclose = function(evt) {
        console.log('Websocket connection closed');
      }

      websocket.onerror = function(evt) {
        console.log('Websocket error: ' + evt);
      }
    });
  </script>
</head>
<body></body>
</html>
